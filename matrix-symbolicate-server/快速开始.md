# 快速开始指南 🚀

这是一个 5 分钟快速上手教程，帮助你快速开始使用 Matrix 符号化服务。

## 第一步：启动服务 (1分钟)

打开终端，进入项目目录：

```bash
cd /Users/momo/Desktop/MatrixTestApp/matrix-symbolicate-server
./start.sh
```

看到以下输出表示启动成功：

```
🚀 Matrix 符号化服务启动在端口 8080
📱 访问地址: http://localhost:8080
```

## 第二步：打开 Web 界面 (30秒)

在浏览器中打开：`http://localhost:8080`

你会看到一个漂亮的渐变紫色界面，包含三个标签页：
- 📤 上传
- 📦 符号表管理
- 📋 报告列表

## 第三步：准备符号表 (2分钟)

### 方法 1：从 DerivedData 获取（推荐）

```bash
# 找到最新的构建产物
cd ~/Library/Developer/Xcode/DerivedData

# 查找 MatrixTestApp 的构建目录
ls -lt | grep MatrixTestApp | head -1

# 进入对应的目录
cd MatrixTestApp-xxxxx/Build/Products/Debug-iphonesimulator/

# 打包 dSYM（如果有 .dSYM 文件）
zip -r ~/Desktop/MatrixTestApp.dSYM.zip MatrixTestApp.app.dSYM

# 或者直接复制 .app 文件
cp -r MatrixTestApp.app ~/Desktop/
```

### 方法 2：重新编译（如果找不到）

1. 在 Xcode 中打开 MatrixTestApp 项目
2. 选择 Product → Clean Build Folder (Shift+Cmd+K)
3. 选择 Product → Build (Cmd+B)
4. 按照方法 1 获取文件

## 第四步：上传符号表 (30秒)

回到 Web 界面：

1. 在「📤 上传」标签页
2. 找到「1️⃣ 上传符号表 (dSYM)」区域
3. 点击或拖拽上传刚才准备的文件
4. 等待上传完成，会显示 UUID

## 第五步：获取卡顿日志 (1分钟)

### 从应用获取日志

1. 在 Xcode 中运行 MatrixTestApp
2. 在应用中触发卡顿：
   - 点击「Matrix 功能演示」
   - 点击「卡顿监控」
   - 点击「模拟主线程卡顿」
3. 等待几秒，日志会保存到应用的 Documents 目录

### 导出日志文件

方法 A - 使用 Xcode：
```bash
# 打开模拟器数据目录
xcrun simctl get_app_container booted com.tencent.MatrixTestApp data

# 进入目录并复制日志
cd Documents/Matrix/
# 找到最新的 .json 文件并复制到桌面
```

方法 B - 使用真机（需要连接 Mac）：
1. 在 Xcode 中：Window → Devices and Simulators
2. 选择你的设备
3. 找到 MatrixTestApp
4. 下载 Documents 文件夹
5. 找到 Matrix 目录下的 JSON 文件

## 第六步：上传和符号化日志 (30秒)

回到 Web 界面：

1. 在「📤 上传」标签页
2. 找到「2️⃣ 上传卡顿日志」区域
3. 点击或拖拽上传日志文件
4. **系统会自动符号化**（通过 UUID 匹配）
5. 符号化完成后会自动打开报告预览

## 第七步：查看报告 (30秒)

在弹出的报告窗口中：

- 看到 👉 标记的是**你的应用代码** - 这是重点！
- 其他是系统框架代码（UIKit、Foundation 等）
- 注意查看文件名和行号，如 `TestLagViewController.mm:145`

## 🎯 完整示例流程

```bash
# 1. 启动服务
cd matrix-symbolicate-server
./start.sh

# 2. 在另一个终端获取符号表
cd ~/Library/Developer/Xcode/DerivedData/MatrixTestApp-*/Build/Products/Debug-iphonesimulator/
zip -r ~/Desktop/MatrixTestApp.dSYM.zip MatrixTestApp.app.dSYM

# 3. 在浏览器打开
open http://localhost:8080

# 4. 上传文件并查看结果
```

## 💡 常见问题

### Q: 找不到符号表？
**A:** 确保在 Xcode 中完整编译过项目（Cmd+B），符号表在 DerivedData 目录。

### Q: 符号化失败？
**A:** 检查：
1. dSYM 的 UUID 是否与日志匹配
2. 应用是否以 Debug 模式编译
3. 是否在同一台 Mac 上编译和符号化

### Q: 没有应用代码？
**A:** 堆栈中可能都是系统代码。尝试：
1. 触发更明显的卡顿（例如主线程 sleep）
2. 确保卡顿发生在你的代码中

### Q: 端口被占用？
**A:** 修改端口：
```bash
PORT=9000 ./start.sh
```

## 🔍 查看详细日志

如果遇到问题，查看服务器输出：

```
✅ 符号表上传成功: 20231220_143025_MatrixTestApp.dSYM.zip (UUID: FD7CB3D0-...)
📥 报告上传成功: 1703056825123456789_lag_report.json
🔍 开始符号化: report=..., dsym=...
✅ 符号化完成: ...
```

## 🎉 下一步

现在你已经掌握了基本用法，可以：

1. 在「📦 符号表管理」中查看和管理所有符号表
2. 在「📋 报告列表」中查看所有历史报告
3. 对比不同版本的性能问题
4. 集成到 CI/CD 流程中自动化处理

## 📚 更多信息

- 详细文档：查看 `README.md`
- API 文档：访问 `/api/health` 测试接口
- Matrix 框架：https://github.com/Tencent/matrix

---

**有问题？** 检查服务器日志输出或查看 README.md 的故障排查部分。

**祝使用愉快！** 🚀

